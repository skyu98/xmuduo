# 1.面向对象编程 
**面向对象编程**：通过将基类中的执行体设为纯虚函数，使得基类指针可以调用派生类各自的执行体；会暴露基类。  
对于TcpServer和EchoServer而言，就是使用EchoServer去继承TcpServer，并且实现其三个虚函数：OnConnection, OnMessage, OnClose;通过基类指针来达到回调效果。

# 2.如果在ThreadRoutine()中this指针已经被delete了，它又怎么去调用Join()呢？

**根本原因在于delete操作符的功能和类对象的内存模型。当一个类对象声明时，系统会为其分配内存空间。在类对象的内存空间中，只有数据成员和虚函数表指针，并不包含代码内容，类的成员函数单独放在代码段中。在调用成员函数时，隐含传递一个this指针，让成员函数知道当前是哪个对象在调用它。当 调用delete this时，类对象的内存空间被释放。在delete this之后进行的其他任何函数调用，只要不涉及到this指针的内容，都能够正常运行。一旦涉及到this指针，如操作数据成员，调用虚函数等，就会出现不可预期的问题。**

根据结果，调用```Join()```时，其```threadId```可能已经被外部改变了，所以可能无法正常完成线程的回收。
因此，在```ThreadRoutine()```中```delete```掉```this```指针，可以使得线程对象在任务完成后自行销毁，但可能造成线程无法正常被回收。应该将它放在delete之前。


